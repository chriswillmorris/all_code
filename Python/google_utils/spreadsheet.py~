import gdata.spreadsheet.service

def login(i_name, i_password):
    """
    i_name (string) : the email of the account to
    log in to
    i_password (string) : the password for the account
    to log in to
    return : the logged-in spreadsheet service client  (gdata.spreadsheeet.service.SpreadsheetsService)
    or None if logging in fails
    """

    client = gdata.spreadsheet.service.SpreadsheetsService()
    client.email = i_name
    client.password = i_password
    client.source = 'Chris Morris\' Bible Reading Schedule Updater'
    try:
        client.ProgrammaticLogin()
    except:
        return None
    return client


def get_spreadsheet_key(i_client, i_name):
    """
    i_client (gdata.spreadsheeet.service.SpreadsheetsService): the already-logged-in spreadsheet
    service client
    i_name (string) : the name of the spreadsheet
    whose key should be retrieved
    return : the key of the indicated spreadsheet
    or None if this spreadsheet is not found
    """

    feed = i_client.GetSpreadsheetsFeed()
    key = None
    for entry in feed.entry:
        if entry.title.text == i_name:
            key = entry.id.text.rsplit('/',1)[1]
            return key
    return key


def get_worksheet_id(i_client, i_spreadsheet_key, i_num):
    """
    i_client (gdata.spreadsheeet.service.SpreadsheetsService) : the already-logged-in spreadsheet
    service client
    i_spreadsheet_key (string) : the key of the
    spreadsheet whose worksheet you want to retrieve
    i_num (integer) : the 0-based index signalling
    which worksheet's key to retrieve
    return : the id of the indicated worksheet
    or None if this worksheet is not found
    """
    feed = i_client.GetWorksheetsFeed(i_spreadsheet_key)

    if i_num >= len(feed.entry):
        return None

    worksheet_id = feed.entry[i_num].id.text.rsplit('/',1)[1]

    return worksheet_id
